name: 16 - Working with Environments
run-name: 16 - Working with Environments
on:
  workflow_dispatch:
jobs:
  deploy-staging:
    name: Deploy to Staging
    runs-on: ubuntu-latest
    environment: staging
    steps:
      - name: Echo Variable
        env:
          ENVIRONMENT_DEPENDENT_VAR: ${{ vars.ENVIRONMENT_DEPENDENT_VAR || 'default' }}
        run: |
          echo "The value of ENVIRONMENT_DEPENDENT_VAR is $ENVIRONMENT_DEPENDENT_VAR"
          echo "Deployed to staging environment"
  e2e-tests:
    name: Run E2E Tests
    runs-on: ubuntu-latest
    needs: deploy-staging
    environment: staging
    steps:
      - name: Echo Variable
        env:
          ENVIRONMENT_DEPENDENT_VAR: ${{ vars.ENVIRONMENT_DEPENDENT_VAR || 'default' }}
        run: |
          echo "Running E2E tests with ENVIRONMENT_DEPENDENT_VAR = $ENVIRONMENT_DEPENDENT_VAR"
          echo "E2E tests completed successfully"
  deploy-production:
    name: Deploy to Production
    runs-on: ubuntu-latest
    needs: e2e-tests
    environment: production
    steps:
      - name: Echo Variable
        env:
          ENVIRONMENT_DEPENDENT_VAR: ${{ vars.ENVIRONMENT_DEPENDENT_VAR || 'default' }}
        run: |
          echo "The value of ENVIRONMENT_DEPENDENT_VAR is $ENVIRONMENT_DEPENDENT_VAR"
          echo "Deployed to production environment"
  send-email:
    name: Send Email Notification
    runs-on: ubuntu-latest
    needs: deploy-production
    steps:
      - name: Notify Completion
        run: |
          echo "Deployment pipeline completed successfully!"
  send-message:
    name: Send Messaging Notification
    runs-on: ubuntu-latest
    needs: deploy-production
    steps:
      - name: Notify Completion
        run: |
          echo "Deployment pipeline completed successfully!"